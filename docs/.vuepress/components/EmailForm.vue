<template>
  <div class="newsletter">
    <div class="newsletter-image">
      <div
        :class="['newsletter-image-item', `newsletter-image-item-${image}`]"
        v-for="image in imageArr"
        :key="image"
      >
        <img v-if="image === 10" src="/img/envelope-gradient.svg" />
        <svg v-else xmlns="http://www.w3.org/2000/svg" viewBox="0 0 457 299">
          <g id="a">
            <rect class="d" x="5" y="5" width="447" height="289" />
            <line class="d" x1="194.84" y1="127.74" x2="5" y2="5" />
            <line class="d" x1="452" y1="5" x2="277.25" y2="117.98" />
          </g>
          <g id="b">
            <path
              class="c"
              d="M274.09,171.8c-1.17-1.3-2.52-2.51-4.04-3.61,1.26-2.29,3.14-5.91,5.02-10.41,1.63-3.9,3.27-8.46,4.51-13.38,1.24-4.92,2.08-10.19,2.08-15.54,0-3.96-.46-7.97-1.59-11.88-.84-2.93-2.06-5.8-3.73-8.53-2.5-4.09-6.01-7.85-10.66-11.02-4.66-3.17-10.44-5.76-17.54-7.62l-.06-.02h-.06c-5.59-1.25-10.69-1.83-15.35-1.83-4.25,0-8.14,.48-11.67,1.4-3.09,.8-5.92,1.94-8.48,3.35-4.48,2.47-8.12,5.81-11.01,9.64-2.17,2.87-3.92,6.03-5.34,9.34-2.12,4.96-3.49,10.28-4.33,15.6-.84,5.32-1.16,10.64-1.16,15.63,0,4.99,.32,9.65,.77,13.63,.23,1.99,.49,3.81,.75,5.43,.02,.13,.04,.25,.06,.38-2.34,.18-4.47,.62-6.37,1.3-1.89,.68-3.55,1.6-4.98,2.7-2.14,1.66-3.71,3.75-4.71,5.99-1.01,2.25-1.46,4.64-1.46,7,0,1.39,.16,2.78,.46,4.12,.47,2.08,1.35,4,2.52,5.7,1.17,1.7,2.64,3.17,4.32,4.37,1.96,1.4,4.05,2.41,6.2,3.05,2.15,.65,4.34,.94,6.51,.94,1.82,0,3.61-.2,5.37-.57,.5,1.64,1.16,3.25,2.03,4.77,1.45,2.55,3.47,4.88,6.09,6.74,2.62,1.86,5.82,3.23,9.57,3.97,2.03,.4,3.98,.6,5.86,.6,2.21,0,4.31-.27,6.27-.77,3.44-.88,6.47-2.47,9.02-4.5,1.17-.93,2.24-1.95,3.22-3.04,.61,.44,1.25,.85,1.91,1.24,1.79,1.05,3.75,1.91,5.87,2.5,2.11,.59,4.38,.91,6.76,.91,1.26,0,2.56-.09,3.89-.28,2.85-.4,5.51-1.32,7.87-2.64,3.55-1.98,6.44-4.84,8.44-8.21,2.01-3.37,3.14-7.27,3.14-11.31,0-2.84-.56-5.75-1.75-8.56-.99-2.34-2.4-4.57-4.22-6.59Zm-58.32,.94c.46,.4,.73,.78,.92,1.16,.19,.42,.3,.87,.3,1.44,0,.58-.12,1.29-.4,2.08-.24,.69-.61,1.45-1.09,2.24-.84,1.37-2.04,2.82-3.5,4.19-1.88,1.77-4.21,3.41-6.73,4.68,.03-2.11,.33-4.22,.84-6.19,.41-1.57,.95-3.05,1.58-4.36,.48-.98,1-1.87,1.55-2.64,.83-1.15,1.71-2.01,2.51-2.53,.4-.26,.78-.44,1.12-.55,.35-.11,.66-.16,.97-.16,.29,0,.59,.04,.92,.15,.3,.1,.63,.25,1,.49Zm26.86,18.84c-.39,1.19-.88,2.37-1.45,3.51-1.5-1.95-2.68-4.11-3.49-6.25-.89-2.35-1.32-4.67-1.32-6.6,0-.96,.11-1.82,.29-2.53,.14-.53,.32-.98,.52-1.35,.15-.27,.31-.5,.48-.69,.26-.28,.53-.48,.86-.64,.34-.16,.76-.28,1.33-.31,.09,0,.18,0,.27,0,.32,0,.58,.04,.81,.1,.2,.05,.37,.13,.54,.22,.29,.16,.57,.39,.85,.74,.42,.52,.84,1.33,1.13,2.4,.29,1.06,.46,2.37,.46,3.82,0,2.31-.42,4.96-1.3,7.59Zm30.12,.93c-1,2.65-2.71,5.03-4.94,6.86-2.23,1.82-4.96,3.09-8.09,3.53-1.04,.15-2.04,.22-3.01,.22-1.61,0-3.12-.19-4.54-.54-2.34-.58-4.44-1.6-6.31-2.92,1.16-2.01,2.09-4.12,2.78-6.24,1.04-3.19,1.56-6.4,1.57-9.42,0-1.68-.16-3.29-.52-4.81-.26-1.14-.64-2.23-1.14-3.26-.38-.77-.83-1.49-1.38-2.16-.81-1-1.85-1.85-3.06-2.44-1.21-.59-2.58-.9-3.99-.89-.22,0-.44,0-.66,.02-1.51,.09-2.94,.5-4.19,1.2-.93,.52-1.75,1.21-2.43,1.99-1.01,1.18-1.7,2.56-2.14,4.01-.43,1.46-.62,3-.63,4.59,0,2.88,.62,5.94,1.78,8.96,.87,2.27,2.04,4.51,3.52,6.63,.65,.93,1.36,1.83,2.13,2.7-.17,.19-.34,.38-.51,.56-1.66,1.71-3.58,3.12-5.78,4.11-2.2,.99-4.69,1.56-7.56,1.57-1.44,0-2.98-.15-4.63-.48-2.65-.53-4.79-1.41-6.53-2.51-1.3-.83-2.39-1.79-3.3-2.86-1.37-1.6-2.35-3.46-3-5.51-.04-.11-.07-.22-.1-.34,2.09-.89,4.08-1.99,5.91-3.23,1.59-1.07,3.06-2.25,4.38-3.51,1.99-1.89,3.65-3.94,4.87-6.11,.61-1.09,1.1-2.2,1.44-3.35,.35-1.15,.55-2.33,.55-3.53,0-1.39-.28-2.8-.89-4.11-.61-1.31-1.56-2.5-2.75-3.46l-.11-.09-.12-.08c-.86-.58-1.76-1.03-2.7-1.33-.93-.3-1.9-.45-2.85-.45-1.2,0-2.36,.24-3.44,.66-.94,.36-1.82,.86-2.63,1.45-1.42,1.03-2.64,2.35-3.71,3.84-1.6,2.25-2.85,4.93-3.73,7.85-.88,2.92-1.37,6.09-1.37,9.3,0,.62,.02,1.24,.06,1.86-1.44,.31-2.87,.48-4.28,.48-1.61,0-3.18-.21-4.69-.67-1.51-.46-2.96-1.15-4.36-2.15-1.11-.79-2.06-1.75-2.8-2.83-.74-1.08-1.28-2.26-1.56-3.52-.2-.89-.31-1.81-.31-2.72,0-1.37,.24-2.72,.72-3.96,.36-.93,.86-1.8,1.51-2.59,.98-1.18,2.3-2.21,4.13-2.98,1.83-.77,4.2-1.26,7.21-1.26,.43,0,.88,.01,1.34,.03l4.15,.19-.95-4.05c-.24-1.01-.49-2.29-.74-3.79-.75-4.5-1.44-10.94-1.44-18.02,0-5.48,.41-11.35,1.5-17.02,.81-4.25,2.01-8.38,3.67-12.16,1.24-2.83,2.75-5.46,4.54-7.8,1.35-1.76,2.86-3.36,4.56-4.77,2.55-2.12,5.52-3.83,9.04-5.03,3.52-1.2,7.61-1.89,12.39-1.89,4.12,0,8.75,.51,13.93,1.65,5.77,1.52,10.43,3.52,14.17,5.83,2.81,1.74,5.11,3.66,6.98,5.71,2.81,3.08,4.69,6.45,5.89,10.06,1.2,3.6,1.72,7.44,1.72,11.34,0,4.69-.74,9.48-1.89,14.01-1.71,6.8-4.31,13.02-6.47,17.5-1.08,2.24-2.06,4.05-2.75,5.3-.35,.62-.63,1.1-.82,1.42-.09,.16-.17,.28-.21,.36l-.05,.08v.02h-.01l-1.75,2.79,2.87,1.62c2.09,1.17,3.78,2.55,5.14,4.06,1.36,1.5,2.38,3.14,3.1,4.84,.86,2.03,1.25,4.08,1.25,6.1,0,1.91-.36,3.79-1.02,5.55Z"
            />
            <g>
              <path
                class="c"
                d="M232.54,132.06c-.32,1.8-.78,3.32-1.33,4.57-.41,.94-.87,1.72-1.35,2.37-.72,.96-1.47,1.6-2.2,2-.73,.4-1.43,.57-2.18,.57-.27,0-.54-.02-.82-.07-.64-.11-1.19-.33-1.69-.66-.38-.25-.73-.56-1.05-.95-.49-.59-.93-1.38-1.25-2.42-.32-1.03-.52-2.31-.52-3.81,0-1.12,.11-2.36,.35-3.72l-6.19-1.1c-.3,1.69-.45,3.3-.45,4.82,0,1.83,.21,3.53,.63,5.09,.32,1.17,.75,2.27,1.3,3.27,.83,1.5,1.94,2.79,3.27,3.76,1.33,.98,2.87,1.63,4.5,1.91,.63,.11,1.27,.17,1.91,.17,1.6,0,3.2-.37,4.66-1.07,1.1-.53,2.12-1.24,3.04-2.1,1.39-1.3,2.55-2.94,3.48-4.87,.93-1.93,1.63-4.15,2.07-6.66l-6.19-1.1h0Z"
              />
              <g>
                <polygon
                  class="c"
                  points="241.67 127.45 241.67 127.45 241.67 127.45 241.67 127.45"
                />
                <path
                  class="c"
                  d="M251.71,126.02c-.13-.43-.31-.85-.55-1.24-.36-.58-.85-1.08-1.39-1.45-.55-.37-1.14-.6-1.72-.73h0c-.37-.08-.75-.13-1.15-.13-.61,0-1.26,.12-1.86,.37-.45,.19-.88,.46-1.26,.77-.57,.48-1.01,1.07-1.36,1.72-.34,.65-.59,1.35-.76,2.11-.15,.66-.23,1.3-.23,1.93,0,.6,.07,1.2,.25,1.77,.13,.43,.31,.85,.55,1.24,.36,.58,.85,1.08,1.39,1.45,.55,.37,1.14,.6,1.72,.73h0c.36,.08,.74,.13,1.14,.13,.61,0,1.26-.12,1.86-.37,.45-.19,.88-.46,1.26-.77,.57-.48,1.01-1.07,1.36-1.72,.34-.65,.59-1.35,.76-2.11h0c.15-.66,.23-1.3,.23-1.93,0-.6-.07-1.2-.25-1.77Z"
                />
              </g>
              <g>
                <polygon
                  class="c"
                  points="204.66 120.61 204.67 120.61 204.67 120.61 204.66 120.61"
                />
                <path
                  class="c"
                  d="M214.34,119.32c-.13-.42-.31-.82-.54-1.19-.35-.56-.83-1.04-1.35-1.39-.53-.35-1.09-.57-1.65-.7-.36-.08-.73-.13-1.12-.13-.58,0-1.2,.11-1.78,.35-.44,.18-.85,.43-1.21,.74-.55,.46-.98,1.02-1.3,1.63-.33,.61-.56,1.27-.72,1.98-.14,.6-.21,1.2-.21,1.78,0,.57,.07,1.14,.24,1.7,.13,.42,.31,.82,.54,1.19,.35,.56,.83,1.04,1.35,1.39,.53,.35,1.09,.57,1.65,.7h0c.35,.08,.72,.13,1.11,.13,.58,0,1.2-.11,1.78-.35,.44-.18,.85-.43,1.21-.74,.55-.46,.98-1.02,1.31-1.63,.33-.61,.56-1.27,.72-1.99h0c.14-.6,.21-1.2,.21-1.78,0-.57-.07-1.14-.24-1.7Z"
                />
                <polygon
                  class="c"
                  points="210.79 116.04 210.8 116.04 210.8 116.04 210.79 116.04"
                />
              </g>
            </g>
          </g>
        </svg>
      </div>
    </div>
    <div class="newsletter-form">
      <div class="newsletter-form-content">
        <div>
          <p class="title">Get Umee updates</p>
          <p>Youâ€™ll be notified with Umee updates, news, and announcements.</p>
        </div>
        <div>
          <GradientBox>
            <form class="newsletter-form-input" @submit.prevent="onSubmit()">
              <input
                type="email"
                required
                placeholder="Your email"
                v-model="email"
              />
              <button v-if="!loading" type="submit" class="gradient-text">
                SIGN UP
              </button>
            </form>
          </GradientBox>
          <div v-show="message" class="newsletter-form-error">
            {{ message }}
          </div>
          <p class="unsubscribe">You can unsubscribe any time.</p>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
export default {
  data() {
    return {
      loading: false,
      email: '',
      message: '',
      darkMode: false,
      imageArr: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14],
    };
  },
  mounted() {
    this.checkUserPreference();
  },
  methods: {
    checkUserPreference() {
      if (localStorage.getItem('dark-theme')) {
        this.darkMode = true;
      }
    },
    onSubmit() {
      this.loading = true;
      const data = {
        email: this.email,
      };
      fetch('https://umee.cc/.netlify/functions/subscribe', {
        method: 'post',
        body: JSON.stringify(data),
      })
        .then((_response) => {
          this.message = "You have been added to Umee's mailing list";
        })
        .catch((_response) => {
          console.log(_response)
          this.message = 'There was a problem adding you to the mailing list.';
        }).finally(() => this.loading = false);
    },
  },
};
</script>

<style lang="scss">
.c {
  fill: var(--c-brand);
}
.d {
  fill: none;
  stroke: var(--c-brand);
  stroke-miterlimit: 10;
  stroke-width: 10px;
}

.newsletter {
  position: relative;
  margin-top: 4.5rem;
  border: 1px solid var(--c-border);
  border-radius: 5px;
  overflow: hidden;
  display: flex;
  justify-content: flex-end;
  min-height: 200px;
  align-items: center;

  .unsubscribe {
    margin-top: 0.5rem;
    font-size: 0.9rem;
    opacity: 0.5;
  }

  &:hover &-image-item {
    opacity: 0.5;
    transform: scale(0.95);
  }

  &:hover &-image-item-10 {
    transform: scale(1.5) rotate(25deg);
    opacity: 1;
  }

  &-image {
    position: absolute;
    display: inline-flex;
    top: 0;
    left: 0;
    width: 400px;
    flex-wrap: wrap;
    transform: translate(-140px, -50px) rotate(-25deg);

    &-item {
      width: 25%;
      padding: 0.5rem;
      transition: 0.5s;
      opacity: 0.7;
      display: flex;

      img {
        background: var(--c-bg);
      }

      &-10 {
        opacity: 1;
        z-index: 1;
      }
    }
  }

  &-form {
    &-content {
      display: flex;
      justify-content: space-between;
      padding: 2rem;
      align-items: center;

      .title {
        font-size: 24px;
      }

      p {
        margin: 0;
      }

      & > div {
        width: 45%;
      }

      @media (max-width: 1024px) {
        display: block;

        & > div {
          width: 100%;

          &:last-child {
            margin-top: 1.5rem;
          }
        }
      }

      @media (max-width: 768px) {
        padding: 1.5rem;
      }
    }

    &-input {
      width: 100%;
      display: flex;
      align-items: center;
      padding: 0.5rem;

      input {
        padding: 0.5rem;
        border: none;
        outline: none;
        background: transparent;
        width: 100%;
        font-size: 16px;
      }

      button {
        border: none;
        font-size: 16px;
        width: 120px;
        font-weight: bold;
        cursor: pointer;
      }
    }
    &-error {
      margin-top: 0.5rem;
    }

    margin-left: 280px;
    width: 100%;

    @media (max-width: 768px) {
      margin-left: 0;
      margin-top: 280px;
    }
  }
}
</style>
